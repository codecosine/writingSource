---
title: Just hack'n
subtitle: a
description: Nothing to see here
time: 2018-2-22 13:44:29
---

# JavaScript变量都是按值传递？

> 这个问题事实上很让人困扰，其实大家也进行了很多的总结归纳。说来滑稽，得到很多“权威”的解释后，我依然云里雾里，在经过一波几折后的折腾研究，才真正理解

## 起因

“JavaScript变量都是按值传递？”这个说法我第一次看到的时候是在小红书，当时作者语气十分强烈，连续举例来引起读者关注，当时给出的例子是这样的。

``` javascript
function setName(obj){
    obj.name="ted";
    obj=new Object();
    obj.name="marry";
}
var person= { name: 'newobj' };
setName(person);
console.log(person);// { name: 'ted' }
```
最终的person 没有因为obj = new Object而被修改。
特意强调了一下，很多程序员因为obj.name能操作就以为函数是按引用传递的，就大错特错了。
我也记了下来，还特意加了注释

- 基本数据类型(Number,String)会按值传递
- 引用数据类型(Object,Array)会按引用地址值传递

## 中转
这件事情烙下一个印，在后面我看小黄书的时候，又再一次发现了这个概念，这次的说法却是：
- 标量原值 scalar primitive 总是通过值复制的方式来赋值/传递，包括:null undefined number boolean string symbol
- 复合值 compound value 总是通过引用复制的方式来赋值/传递，包括:object,array Object,function

这个时候我意识到，当时小红书的说法是有非常大的误解的，虽然这个误解比较大可能是因为翻译不准确的缘故。转念一想，按引用地址值传递和引用复制传递，其实说的也是一回事。反正现象就是这个现象，知道就好了嘛^^

## 所以为什么有这个问题

在逛知乎的时候看到了这个问题，有人提出了相似的疑问。这次的回答给出了比较容易让人理解的说法：
复合值的传递事实上有三种方式：
- 1.将参数的值完全复制一份，按值传递
对于传递过来的变量进行修改等各种操作，不会影响到函数外原变量。
PHP就是使用的这种方式
- 2.将参数的地址复制一份，按值传递地址，即引用复制（reference-copy）传递
JavaScript就是这种方式，我就不再解释了
- 3、对于参数的完全引用传递
也就是C语言中指针的感觉
特征：无论是对于变量成员的修改，还是对变量重新赋值，都会影响到原对象。

然而到这里，我突然才发现，这个问题对于我来说其实不是值怎么传的问题。
因为问题早就已经解决掉了，我也没有很大的疑惑。

### 这个问题的特殊性
引用，地址，值，指针。
事实上对于我来说这些概念十分的模糊且带有直觉性。
当然很大程度是因为中文的说法本身带有的语义性。如果原先没有对概念有清晰的认识的话，很容易受到你熟悉语言的直觉干扰。

### 重新认识赋值“=”
``` javascript
var a = 1
var b = a
b++
var c = { name: 'jack'}
var d = c
d.name = 'peter'
d = { name: 'Bob'}

// todo 待补充
```
首先 变量声明赋值因为提升，所以变量总是先声明后赋值
```
var a
a = 1
```
<!-- 下面的说法是比较个人的理解：
var a 会LHS访问作用域，是否存在相同变量，如果存在则忽略当前声明
a = 1 会LHS访问作用域寻找a，不关心a当前的值是多少，只想找到=2的赋值目标
跳过部分
b = a 会LHS寻找b,RHS寻找a
**关键**
- LHS是使用变量名找到地址
- RHS是使用变量名找到地址，再通过地址再去找到具体值
我们说某某变量存了什么值
往往是指RHS的结果
比如console.log(b),就是对b进行RHS查询
也就是RHS的查询我们也可以理解为LHS也是可以相当于其中一步
- ** 赋值的操作都是地址的传递,基本值和复合值的区别只在存放的位置 ** 
d.name = 'peter'的核心是寻址LHS -->

待续写，这里会分开一篇文章写RHS





## 参考资料
小红书
你不知道的JavaScript的部分章节
[JavaScript中函数都是值传递吗？](https://www.zhihu.com/question/51018162)